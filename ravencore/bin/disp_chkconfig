#!/bin/bash
#
#                  RavenCore Hosting Control Panel
#                Copyright (C) 2005  Corey Henderson
#
#     This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
#

runlevel=$1
runlevel=3

echo "<h2>Services set to start on boot ( runlevel 3 )</h2>"

echo "<table cellpadding=0 cellspacing=0 border=0><tr>"

for i in `chkconfig --list | grep '^[[:alpha:]]' | grep -v 'based services' | awk '{print $1}' | sort`; do

    echo "<tr><td>$i</td>"

    e=$(chkconfig --list $i | sed "s/$i//" | awk "{print \$$(expr $runlevel "+" 1)}")
    echo 
    status=$(echo $e | sed 's/.*://')
    
    case $status in
	on)
	    new_status=off
	    ;;
	off)
	    new_status=on
	    ;;
	*)
	    new_status=reset
	    ;;
    esac

    echo "<td>&nbsp; &nbsp; $status <a href=\"chkconfig.php?service=$i&status=$new_status\">*</a></td>"

    echo "</tr>"

done

echo "</table>"
